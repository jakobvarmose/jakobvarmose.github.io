{"version":3,"sources":["Media.js","Size.js","MediaList.js","Home.js","LogIn.js","LogOut.js","Room.js","RoomList.js","Server.js","Register.js","User.js","UserCreate.js","UserList.js","App.js","index.js"],"names":["Media","homeserver","api2","useParams","domain","local","history","useHistory","useState","Item","to","substr","onClick","Modal","confirm","title","content","onOk","push","error","toString","src","Size","size","s","Number","toFixed","disabled","media","setMedia","a","value","moment","label","showTime","defaultValue","onChange","v","encodeURIComponent","Date","getTime","res","success","deleted","useEffect","media2","users","user","name","res2","map","creator","console","log","columns","render","media_id","media_type","startsWith","width","height","dataIndex","media_length","dataSource","Home","LogIn","onLogIn","matrixID","setMatrixID","password","setPassword","setHomeserver","setDisabled","username","includes","indexOf","e","target","Password","LogOut","userID","onLogOut","Room","roomID","room","setRoom","members","setMembers","homeservers","setHomeservers","Set","id","sort","canonical_alias","purge_up_to_ts","purge_id","status","Promise","resolve","setTimeout","TabPane","tab","key","Object","entries","member","RoomList","rooms","setRooms","from","rooms2","undefined","next_batch","room_id","sorter","b","joined_members","joined_local_members","version","Server","server","federation","setFederation","python_version","server_version","synapse","setSynapse","client","setClient","capabilities","setCapabilities","versions","unstable_features","keys","filter","JSON","stringify","available","default","Register","admin","setAdmin","sharedSecret","setSharedSecret","message","setMessage","fetch","method","json","nonce","TextEncoder","adminString","window","crypto","subtle","importKey","encode","hash","data","Uint8Array","sign","mac","body","Array","prototype","call","x","slice","join","errcode","checked","User2","setUser","devices","setDevices","deviceID","device_id","onClickChangePassword","deactivated","erase","joined_rooms","forEach","toISOString","last_seen_ts","deleteDevice","React","Component","UserCreate2","onCreateUser","UserList","onChangeActive","onChangeAdmin","self","modalCreateOpen","setModalCreateOpen","visible","okText","onCancel","App","state","accessToken","api","url","headers","Authorization","obj","ok","statusText","setState","type","identifier","initial_device_display_name","localStorage","setItem","access_token","user_id","refresh","active","prompt","onChangePassword","removeItem","getItem","this","Content","style","padding","backgroundColor","path","exact","children","User","MediaList","Footer","textAlign","color","ReactDOM","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.418bf5f6.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useHistory, useParams } from 'react-router-dom';\nimport { Breadcrumb, Button, Modal } from 'antd';\n\nfunction Media({ homeserver, api2 }) {\n  let { domain, local } = useParams();\n  let history = useHistory();\n  let [media, setMedia] = useState({});\n\n  function onClickDelete() {\n    Modal.confirm({\n      title: 'Delete media',\n      content: (\n        <>\n          This will delete this media item permanently.\n        </>\n      ),\n      async onOk() {\n        try {\n          await api2('DELETE', `/_synapse/admin/v1/media/${domain}/${local}`)\n          history.push('/media');\n        } catch (e) {\n          Modal.error({\n            content: e.toString(),\n          });\n        }\n      },\n    });\n  }\n\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n          <Link to=\"/media\">Media</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            {`mxc://${domain}/${local}`}\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <p>\n        { domain === homeserver.substr(8) ? <Button onClick={onClickDelete}>Delete</Button> : null }\n      </p>\n      <p>\n        <img src={`${homeserver}/_matrix/media/r0/download/${domain}/${local}`}/>\n      </p>\n    </div>\n  );\n}\n\nexport default Media;\n","import React from 'react';\n\nfunction Size({ size }) {\n  let s = Number(size);\n  return (\n    <span>\n      {\n        s < 1000 ?\n          `${s}`\n        : s < 1000000 ?\n          `${(s/1000).toFixed(2)}k`\n        : s < 1000000000 ?\n          `${(s/1000000).toFixed(2)}M`\n        :\n          `${(s/1000000000).toFixed(2)}G`\n      }\n    </span>\n  );\n}\n\nexport default Size;\n","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb, Button, DatePicker, Form, Modal, Table } from 'antd';\nimport moment from 'moment';\n\nimport Size from './Size';\n\nfunction Media({ homeserver, api2 }) {\n  let [disabled, setDisabled] = useState(false);\n\n  let [media, setMedia] = useState([]);\n\n  /*useEffect(async () => {\n    let from = 0;\n    let media2 = [];\n    while (from !== undefined) {\n      const res = await api2('GET', `/_synapse/admin/v1/rooms?from=${encodeURIComponent(from)}`);\n      for (let room of res.rooms) {\n        const res2 = await api2('GET', `/_synapse/admin/v1/room/${room.room_id}/media`);\n        media2 = [...media2, ...res2.local, ...res2.remote];\n        setMedia(media2)\n      }\n      from = res.next_batch;\n    }\n  }, []);*/\n  useEffect(async () => {\n    try {\n      let media2 = [];\n      const res = await api2('GET', `/_synapse/admin/v2/users?from=0&limit=10000&deactivated=true`);\n      for (let user of res.users) {\n        const res2 = await api2('GET', `/_synapse/admin/v1/users/${encodeURIComponent(user.name)}/media`);\n        media2 = [...media2, ...res2.media.map(media => ({...media, creator: user.name}))];\n        console.log(res2);\n        setMedia(media2)\n        console.log(media2)\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  }, [])\n\n  async function onClickPurgeMediaCache() {\n    let value = moment();\n    Modal.confirm({\n      title: 'Purge media cache',\n      content: (\n        <>\n          This will delete all remote media before a given time.\n          <Form.Item label=\"Before\">\n            <DatePicker\n              showTime\n              defaultValue={value}\n              onChange={v => value = v}\n            ></DatePicker>\n          </Form.Item>\n        </>\n      ),\n      async onOk() {\n        try {\n          let res = await api2('POST',`/_synapse/admin/v1/purge_media_cache?before_ts=${encodeURIComponent(new Date(value).getTime())}`, {});\n          Modal.success({\n            content: `${res.deleted} items deleted`,\n          });\n        } catch(e) {\n          Modal.error({\n            content: e.toString(),\n          });\n        }\n      },\n    });\n  }\n\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            Media\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <p>\n        <Button disabled={disabled} onClick={onClickPurgeMediaCache}>\n          Purge media cache\n        </Button>\n      </p>\n      <Table\n        columns={\n          [\n            {\n              render: ({media_id, media_type}) => (\n                <Link to={`/media/${homeserver}/${media_id}`}>\n                  {\n                    media_type.startsWith('image/') ?\n                    <img width=\"32\" height=\"32\" src={`https://${homeserver}/_matrix/media/r0/thumbnail/${homeserver}/${media_id}?width=32&height=32`}/> : null\n                  }\n                </Link>\n              ),\n            },\n            {\n              title: 'ID',\n              render: ({media_id}) => (\n                  <Link to={`/media/${homeserver}/${media_id}`}>mxc://{homeserver}/{media_id}</Link>\n              ),\n            },\n            {\n              title: 'Creator',\n              render: ({creator}) => <Link to={`/user/${creator}`}>{creator}</Link>,\n            },\n            {\n              title: 'Type',\n              dataIndex: 'media_type',\n            },\n            {\n              title: 'Size',\n              render: ({media_length}) => <Size size={media_length}/>,\n            },\n            {\n              title: 'Filename',\n              dataIndex: 'upload_name',\n            },\n          ]\n        }\n        dataSource={\n          media\n        }\n      />\n    </div>\n  );\n}\n\nexport default Media;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb } from 'antd';\n\nfunction Home({ api2 }) {\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            Home\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <p><Link to=\"/user\">Users</Link> | <Link to=\"/room\">Rooms</Link> | <Link to=\"/media\">Media</Link> | <Link to=\"/server\">Server info</Link></p>\n    </div>\n  );\n}\n\nexport default Home;\n","import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Button, Form, Input } from 'antd';\n\nfunction LogIn({ onLogIn }) {\n  let [matrixID, setMatrixID] = useState('');\n  let [password, setPassword] = useState('');\n  let [homeserver, setHomeserver] = useState('');\n  let [disabled, setDisabled] = useState(false);\n  function onChangeMatrixID(e) {\n    setMatrixID(e.target.value);\n    if (e.target.value.indexOf(':') >=0) {\n      setHomeserver(e.target.value.substr(e.target.value.indexOf(':')+1));\n    }\n  }\n  function onChangePassword(e) {\n    setPassword(e.target.value);\n  }\n  function onChangeHomeserver(e) {\n    setHomeserver(e.target.value);\n  }\n  async function onClickLogIn() {\n    try {\n      setDisabled(true)\n      let username = matrixID;\n      if (username.startsWith('@') && username.includes(':')) {\n        username = username.substr(1, username.indexOf(':')-1)\n      }\n      await onLogIn(\n        username,\n        password,\n        homeserver,\n      );\n    } catch (e) {\n      //setMessage(e.toString());\n    }\n    setDisabled(false);\n  }\n  return (\n    <Form>\n      <h3>Log in</h3>\n      <Form.Item label=\"MatrixID\">\n        <Input disabled={disabled} value={matrixID} onChange={onChangeMatrixID}/>\n      </Form.Item>\n      <Form.Item label=\"Password\">\n        <Input.Password disabled={disabled} value={password} onChange={onChangePassword}/>\n      </Form.Item>\n      <Form.Item label=\"Homeserver\">\n        <Input disabled={disabled} value={homeserver} onChange={onChangeHomeserver}/>\n      </Form.Item>\n      <Form.Item>\n        <Button disabled={disabled} onClick={onClickLogIn}>Log in</Button>\n      </Form.Item>\n      <Form.Item>\n        <Link to=\"/register\">Register</Link>\n      </Form.Item>\n    </Form>\n  );\n}\n\nexport default LogIn;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Button } from 'antd';\n\nfunction LogOut({ userID, onLogOut }) {\n  let [disabled, setDisabled] = useState(false);\n  async function onClickLogOut() {\n    setDisabled(true);\n    await onLogOut();\n    setDisabled(false);\n  }\n  return (\n    <p>\n      Logged in as <Link to={'/user/'+userID}>{userID}</Link> <Button disabled={disabled} onClick={onClickLogOut}>Log out</Button>\n    </p>\n  );\n}\n\nexport default LogOut;\n","import React, { useEffect, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { Breadcrumb, Button, Modal, Table, Tabs } from 'antd';\n\nfunction Room({ api2 }) {\n  let { roomID } = useParams();\n  let [room, setRoom] = useState({});\n  let [members, setMembers] = useState([]);\n  let [homeservers, setHomeservers] = useState([]);\n  useEffect(async () => {\n    let res = await api2('GET', `/_synapse/admin/v1/rooms/${encodeURIComponent(roomID)}`);\n    setRoom(res);\n    console.log(res);\n    let res2 = await api2('GET', `/_synapse/admin/v1/rooms/${encodeURIComponent(roomID)}/members`);\n    setMembers(res2.members);\n    setHomeservers([...new Set(res2.members.map(id => id.substr(id.indexOf(':') + 1)))].sort())\n  }, [roomID])\n\n  function onClickPurgeHistory() {\n    Modal.confirm({\n      title: `Purge history of ${room.canonical_alias || roomID}`,\n      content: `Do you want to purge the room history of ${room.canonical_alias || roomID}?`,\n      async onOk() {\n        let res = await api2('POST', `/_synapse/admin/v1/purge_history/${roomID}`, {\n          purge_up_to_ts: new Date().getTime(),\n        });\n        let {purge_id} = res;\n        let status = 'active'\n        while(status === 'active') {\n          await new Promise(resolve => setTimeout(resolve, 1000));\n          let res2 = await api2('GET', `/_synapse/admin/v1/purge_history_status/${purge_id}`);\n          status = res2.status;\n        }\n\n        if (status === 'complete') {\n          Modal.success({\n            content: 'Purge succeeded',\n          });\n        } else {\n          Modal.error({\n            content: 'Purge failed',\n          });\n        }\n      },\n    });\n  }\n\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            <Link to=\"/room\">Rooms</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            {room.canonical_alias || roomID}\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <Button onClick={onClickPurgeHistory}>\n        Purge history\n      </Button>\n      <Tabs>\n        <Tabs.TabPane tab=\"Properties\" key=\"1\">\n          <Table\n            columns={\n              [\n                {\n                  title: 'Key',\n                  dataIndex: 0,\n                },\n                {\n                  title: 'Value',\n                  dataIndex: 1,\n                },\n              ]\n            }\n            dataSource={Object.entries(room)}\n          />\n        </Tabs.TabPane>\n        <Tabs.TabPane tab=\"Homeservers\" key=\"2\">\n          <Table\n            columns={\n              [\n                {\n                  title: 'Name',\n                },\n              ]\n            }\n            dataSource={homeservers}\n          />\n        </Tabs.TabPane>\n        <Tabs.TabPane tab=\"Members\" key=\"3\">\n        <Table\n            columns={\n              [\n                {\n                  title: 'MatrixID',\n                  render: member => <Link to={`/user/${member}`}>{member}</Link>,\n                },\n              ]\n            }\n            dataSource={members}\n          />\n        </Tabs.TabPane>\n      </Tabs>\n    </div>\n  );\n}\n\nexport default Room;\n","import React, { useEffect, useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb, Table } from 'antd';\n\nfunction RoomList({ api2 }) {\n  let [rooms, setRooms] = useState([]);\n  useEffect(async () => {\n    let from = 0;\n    let rooms2 = [];\n    setRooms(rooms2);\n    while (from !== undefined) {\n      const res = await api2('GET', `/_synapse/admin/v1/rooms?order_by=joined_members&from=${encodeURIComponent(from)}`);\n      rooms2 = [...rooms2, ...res.rooms];\n      setRooms(rooms2);\n      from = res.next_batch;\n    }\n  }, [])\n  return (\n    <>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            Rooms\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <Table\n        columns={\n          [\n            {\n              title: 'Alias',\n              render: ({room_id, canonical_alias}) => (\n                <Link to={`/room/${room_id}`}>{ canonical_alias || room_id}</Link>\n              ),\n              sorter: (a, b) => (a.canonical_alias||a.room_id) < (b.canonical_alias||b.room_id) ? -1 : (a.canonical_alias||a.room_id) > (b.canonical_alias||b.room_id) ? 1 : 0,\n            },\n            {\n              title: 'Name',\n              dataIndex: 'name',\n              sorter: (a, b) => a.name < b.name ? -1 : a.name > b.name ? 1 : 0,\n            },\n            {\n              title: 'Members',\n              dataIndex: 'joined_members',\n              sorter: (a, b) => a.joined_members - b.joined_members,\n            },\n            {\n              title: 'Local members',\n              dataIndex: 'joined_local_members',\n              sorter: (a, b) => a.joined_local_members - b.joined_local_members,\n            },\n            {\n              title: 'Version',\n              dataIndex: 'version',\n              sorter: (a, b) => a.version < b.version ? -1 : a.version > b.version ? 1 : 0,\n            },\n          ]\n        }\n        dataSource={\n          rooms\n        }\n      />\n    </>\n  );\n}\n\nexport default RoomList;\n","import React, { useEffect, useState } from \"react\";\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb } from 'antd';\n\nfunction Server({api2}) {\n  let [federation, setFederation] = useState({\n    server: '',\n    version: '',\n  });\n  let [synapse, setSynapse] = useState({\n    python_version: '',\n    server_version: '',\n  });\n  let [client, setClient] = useState({});\n  let [capabilities, setCapabilities] = useState(null);\n  useEffect(async () => {\n    const res = await api2('GET', '/_matrix/federation/v1/version');\n    setFederation(res);\n  }, [])\n  useEffect(async () => {\n    const res = await api2('GET', '/_synapse/admin/v1/server_version');\n    setSynapse(res);\n  }, [])\n  useEffect(async () => {\n    const res = await api2('GET', '/_matrix/client/versions');\n    setClient(res);\n  }, [])\n  useEffect(async () => {\n    const res = await api2('GET', '/_matrix/client/r0/capabilities');\n    setCapabilities(res.capabilities);\n  }, [])\n\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            Server info\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <p>Server: {federation.server.name}</p>\n      <p>Version: {synapse.server_version || federation.server.version}</p>\n      {synapse.python_version ?\n        <p>Python version: {synapse.python_version}</p>\n      :\n        null\n      }\n      {client.versions ?\n        <div>\n          <p>API versions:</p>\n          <ul>\n            {client.versions.map(version => (\n              <li key={version}>{version}</li>\n            ))}\n          </ul>\n        </div>\n      :\n        null\n      }\n      {client.unstable_features ?\n        <div>\n          <p>Unstable features:</p>\n          <ul>\n            {Object.keys(client.unstable_features).filter(key => client.unstable_features[key]).map(key => (\n              <li key={key}>{key}</li>\n            ))}\n          </ul>\n        </div>\n      :\n        null\n      }\n      {capabilities ?\n        <div>\n          <p>Capabilities:</p>\n          <ul>\n            {\n              Object.keys(capabilities).filter(key => key !== 'm.room_versions').sort().map(key => (\n                <li key={key}>{key}: {JSON.stringify(capabilities[key])}</li>\n              ))\n            }\n          </ul>\n          {capabilities['m.room_versions'] ?\n            <div>\n              <p>Room Versions:</p>\n              <ul>\n                {Object.keys(capabilities['m.room_versions'].available).sort().map(key => (\n                  <li key={key}>{key}: {capabilities['m.room_versions'].available[key]}{key === capabilities['m.room_versions'].default ? ' (default)' : ''}</li>\n                ))}\n              </ul>\n            </div>\n          :\n            null\n          }\n        </div>\n      :\n        null\n      }\n    </div>\n  );\n}\n\nexport default Server;\n","import React, { useState } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { Button, Checkbox, Form, Input } from 'antd';\n\nfunction Register({ onLogIn }) {\n\n  let [matrixID, setMatrixID] = useState('');\n  let [password, setPassword] = useState('');\n  let [homeserver, setHomeserver] = useState('');\n  let [admin, setAdmin] = useState(false);\n  let [sharedSecret, setSharedSecret] = useState('');\n  let [message, setMessage] = useState('');\n  let [disabled, setDisabled] = useState(false);\n\n  function onChangeMatrixID(e) {\n    setMatrixID(e.target.value);\n    if (e.target.value.indexOf(':') >=0) {\n      setHomeserver(e.target.value.substr(e.target.value.indexOf(':')+1));\n    }\n  }\n  function onChangePassword(e) {\n    setPassword(e.target.value);\n  }\n  function onChangeHomeserver(e) {\n    setHomeserver(e.target.value);\n  }\n  function onChangeAdmin(e) {\n    let value = e.target.checked;\n    setAdmin(value);\n  }\n  function onChangeSharedSecret(e) {\n    setSharedSecret(e.target.value);\n  }\n  async function onClickRegister() {\n    try {\n      setMessage('');\n      let username = matrixID;\n      if (username.startsWith('@') && username.includes(':')) {\n        username = username.substr(1, username.indexOf(':')-1)\n      }\n      const res = await (await fetch('https://' + homeserver + '/_synapse/admin/v1/register', {\n        method: 'GET',\n      })).json();\n      const nonce = res.nonce;\n      const e = new TextEncoder('utf-8')\n      const adminString = admin ? 'admin' : 'notadmin';\n      const key = await window.crypto.subtle.importKey('raw', e.encode(sharedSecret), {\n        name: 'HMAC',\n        hash: { name: 'SHA-1' },\n      }, false, ['sign']);\n      const data = new Uint8Array([\n        ...e.encode(nonce),\n        0x00,\n        ...e.encode(username),\n        0x00,\n        ...e.encode(password),\n        0x00,\n        ...e.encode(adminString),\n      ]);\n      const mac = await window.crypto.subtle.sign('HMAC', key, data);\n      const res2 = await (await fetch('https://' + homeserver + '/_synapse/admin/v1/register', {\n        method: 'POST',\n        body: JSON.stringify({\n          nonce: nonce,\n          username: username,\n          password: password,\n          admin: admin,\n          mac: Array.prototype.map.call(new Uint8Array(mac), x => ('0' + x.toString(16)).slice(-2)).join(''),\n        }),\n      })).json();\n      if ('errcode' in res2) {\n        setMessage(res2.errcode + ': ' + res2.error);\n      } else {\n        setMatrixID('');\n        setPassword('');\n        setAdmin(false);\n        setSharedSecret('');\n        await onLogIn(username, password, homeserver);\n      }\n    } catch(e) {\n      setMessage(e.toString());\n    }\n  }\n  return (\n    <Form>\n      <h3>Register</h3>\n      <Form.Item>\n\n      </Form.Item>\n      <Form.Item label=\"MatrixID\">\n        <Input disabled={disabled} value={matrixID} onChange={onChangeMatrixID}/>\n      </Form.Item>\n      <Form.Item label=\"Password\">\n        <Input.Password disabled={disabled} value={password} onChange={onChangePassword}/>\n      </Form.Item>\n      <Form.Item label=\"Homeserver\">\n        <Input disabled={disabled} value={homeserver} onChange={onChangeHomeserver}/>\n      </Form.Item>\n      <Form.Item>\n        <Checkbox disabled={disabled} checked={admin} onChange={onChangeAdmin}>Admin</Checkbox>\n      </Form.Item>\n      <Form.Item label=\"registration_shared_secret (from homeserver.yaml)\">\n        <Input id=\"sharedSecret\" disabled={disabled} value={sharedSecret} onChange={onChangeSharedSecret} />\n      </Form.Item>\n      <Form.Item>\n        {message}\n      </Form.Item>\n      <Form.Item>\n        <Button disabled={disabled} onClick={onClickRegister}>Register</Button>\n      </Form.Item>\n      <Form.Item>\n        <Link to=\"/\">Log in</Link>\n      </Form.Item>\n    </Form>\n  );\n}\n\nexport default Register;\n\n","import React, { useEffect, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { Breadcrumb, Button, Form, Input, Modal, Table, Tabs } from 'antd';\nimport Checkbox from 'antd/lib/checkbox/Checkbox';\n\nfunction User2({api2}) {\n  let {userID} = useParams();\n  let [user, setUser] = useState({});\n  let [rooms, setRooms] = useState([]);\n  let [devices, setDevices] = useState([]);\n\n  useEffect(async () => {\n    try {\n      let res = await api2('GET', '/_synapse/admin/v2/users/'+userID);\n      setUser({\n        ...user,\n        ...res,\n      });\n    } catch (e) {\n      console.error(e)\n    }\n  }, []);\n  useEffect(async () => {\n    try {\n      let res = await api2('GET', '/_synapse/admin/v2/users/'+userID+'/devices');\n      if ('devices' in res) {\n        setDevices(res.devices);\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, []);\n  useEffect(async () => {\n    try {\n      let res = await api2('GET', '/_synapse/admin/v1/users/'+userID+'/joined_rooms');\n      if ('joined_rooms' in res) {\n        let rooms2 = res.joined_rooms.map(room_id => ({\n          room_id: room_id,\n        }));\n        setRooms(rooms2);\n        res.joined_rooms.forEach(async (room_id) => {\n          let res = await api2('GET', '/_synapse/admin/v1/rooms/'+room_id)\n          rooms2 = rooms2.map(room => {\n            if (room.room_id != res.room_id) {\n              return room;\n            }\n            return {\n              ...room,\n              ...res,\n            };\n          });\n          setRooms(rooms2);\n        })\n      }\n    } catch (e) {\n      console.error(e)\n    }\n  }, []);\n\n  async function deleteDevice(deviceID) {\n    await api2('POST', '/_synapse/admin/v2/users/'+userID+'/delete_devices', {\n      devices: [deviceID],\n    });\n    setDevices(devices.filter(({device_id}) => device_id !== deviceID));\n  };\n\n  async function onClickChangePassword() {\n    let password = '';\n    Modal.confirm({\n      title: `Change password for ${userID}`,\n      content: (\n        <>\n          <Form.Item label=\"New password\">\n            <Input.Password onChange={e => password = e.target.value}/>\n          </Form.Item>\n        </>\n      ),\n      async onOk() {\n        try {\n          if (!password) {\n            throw 'Empty password'\n          }\n          await api2('PUT', '/_synapse/admin/v2/users/'+userID, {\n            deactivated: false,\n            password: password,\n          });\n          setUser({\n            ...user,\n            deactivated: 0,\n          });\n        } catch (e) {\n          Modal.error({\n            content: e.toString(),\n          });\n        }\n      },\n    });\n  }\n  async function onClickDeactivate() {\n    let erase = false;\n    Modal.confirm({\n      title: `Deactivate ${userID}`,\n      content: (\n        <>\n          This will deactivate the account {userID}.\n          <Form.Item>\n            <Checkbox onChange={e => erase = e.target.checked}>Also erase</Checkbox>\n          </Form.Item>\n        </>\n      ),\n      async onOk() {\n        try {\n          await api2('POST', `/_synapse/admin/v1/deactivate/${encodeURIComponent(userID)}`, {\n            erase: erase,\n          });\n          setUser({\n            ...user,\n            deactivated: 1,\n          });\n        } catch (e) {\n          Modal.error({\n            content: e.toString(),\n          });\n        }\n      },\n    });\n  }\n  async function onClickMakeAdmin() {\n    await api2('PUT', `/_synapse/admin/v2/users/${encodeURIComponent(userID)}`, {\n      admin: true,\n    });\n    setUser({\n      ...user,\n      admin: 1,\n    })\n  }\n  async function onClickRemoveAdmin() {\n    try {\n      await api2('PUT', `/_synapse/admin/v2/users/${encodeURIComponent(userID)}`, {\n        admin: false,\n      });\n      setUser({\n        ...user,\n        admin: 0,\n      })\n    } catch (e) {\n      Modal.error({\n        content: e.toString(),\n      });\n    }\n  }\n  \n\n  return (\n    <div>\n      <div>\n        <p>\n          <Breadcrumb>\n            <Breadcrumb.Item>\n              <Link to=\"/\">Home</Link>\n            </Breadcrumb.Item>\n            <Breadcrumb.Item>\n              <Link to=\"/user\">Users</Link>\n            </Breadcrumb.Item>\n            <Breadcrumb.Item>\n              {userID}\n            </Breadcrumb.Item>\n          </Breadcrumb>\n        </p>\n        {\n          user.deactivated === 0 ?\n          <>\n          <Button onClick={onClickChangePassword}>\n            Change password\n          </Button>\n          <Button onClick={onClickDeactivate}>\n            Deactivate\n          </Button>\n          </> : null\n        }\n        {\n          user.deactivated === 1 ?\n          <Button onClick={onClickChangePassword}>\n            Activate and set password\n          </Button> : null\n        }\n        {\n          user.admin === 0 ?\n          <Button onClick={onClickMakeAdmin}>\n            Make admin\n          </Button> : null\n        }\n        {\n          user.admin === 1 ?\n          <Button onClick={onClickRemoveAdmin}>\n            Remove admin\n          </Button> : null\n        }\n        <Tabs>\n          <Tabs.TabPane tab=\"Properties\" key=\"1\">\n            <Table\n              columns={\n                [\n                  {\n                    title: 'Key',\n                    dataIndex: '0',\n                  },\n                  {\n                    title: 'Value',\n                    dataIndex: '1',\n                  },\n                ]\n              }\n              dataSource={Object.entries(user).map(([key, value]) => (\n                key === 'creation_ts' ?\n                  [key, new Date(user[key]*1000).toISOString()]\n                :\n                  [key, value]\n              ))}\n            />\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"Devices\" key=\"2\">\n            <Table\n              columns={\n                [\n                  {\n                    title: 'ID',\n                    dataIndex: 'device_id',\n                  },\n                  {\n                    title: 'Name',\n                    dataIndex: 'display_name',\n                  },\n                  {\n                    title: 'Last seen',\n                    render: ({last_seen_ts}) => last_seen_ts?new Date(last_seen_ts).toISOString():'',\n                  },\n                  {\n                    title: 'IP address',\n                    dataIndex: 'last_seen_ip',\n                  },\n                  {\n                    render: ({device_id}) => (\n                      <Button onClick={() => deleteDevice(device_id)}>Delete</Button>\n                    )\n                  }\n                ]\n              }\n              dataSource={devices}\n            />\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"Joined rooms\" key=\"3\">\n            <Table\n              columns={\n                [\n                  {\n                    title: 'ID',\n                    render: ({room_id, canonical_alias}) => (\n                      <Link to={`/room/${room_id}`}>{canonical_alias?canonical_alias:room_id}</Link>\n                    )\n                  },\n                  {\n                    title: 'Name',\n                    dataIndex: 'name',\n                  },\n                  {\n                    title: 'Members',\n                    dataIndex: 'joined_members',\n                  },\n                  {\n                    title: 'Version',\n                    dataIndex: 'version',\n                  },\n                ]\n              }\n              dataSource={rooms}\n            />\n          </Tabs.TabPane>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n\nexport default User2;\n","import React, { useState } from \"react\";\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb, Button, Checkbox, Form, Input } from \"antd\";\n\nfunction UserCreate2({ onCreateUser }) {\n  let [matrixID, setMatrixID] = useState('');\n  let [password, setPassword] = useState('');\n  let [admin, setAdmin] = useState(false);\n\n  function onClickCreateUser() {\n    onCreateUser(matrixID, password, admin);\n  };\n  function onChangeMatrixID(e) {\n    setMatrixID(e.target.value);\n  };\n  function onChangePassword(e) {\n    setPassword(e.target.value);\n  };\n  function onChangeAdmin(e) {\n    setAdmin(e.target.checked);\n  };\n  \n\n  return (\n    <div>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            <Link to=\"/user\">Users</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            Create\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <Form>\n        <Form.Item label=\"MatrixID\">\n          <Input value={matrixID} onChange={onChangeMatrixID}/>\n        </Form.Item>\n        <Form.Item label=\"Password\">\n          <Input.Password value={password} onChange={onChangePassword}/>\n        </Form.Item>\n        <Form.Item>\n          <Checkbox checked={admin} onChange={onChangeAdmin}>Admin</Checkbox>\n        </Form.Item>\n        <Form.Item>\n          <Button onClick={onClickCreateUser}>Create</Button>\n        </Form.Item>\n      </Form>\n    </div>\n  );\n}\n\nclass UserCreate extends React.Component {\n  state = {\n    matrixID: '',\n    password: '',\n    admin: false,\n  };\n  onCreateUser = () => {\n    this.props.onCreateUser(this.state.matrixID, this.state.password, this.state.admin);\n  };\n  onChangeValue = (e) => {\n    this.setState({\n      [e.target.id]: e.target.value,\n    });\n  };\n  onChangeChecked = (e) => {\n    this.setState({\n      [e.target.id]: e.target.checked,\n    });\n  };\n  render() {\n    return (\n      <div>\n        <p>\n          <Breadcrumb>\n            <Breadcrumb.Item>\n              <Link to=\"/\">Home</Link>\n            </Breadcrumb.Item>\n            <Breadcrumb.Item>\n              <Link to=\"/user\">Users</Link>\n            </Breadcrumb.Item>\n            <Breadcrumb.Item>\n              Create\n            </Breadcrumb.Item>\n          </Breadcrumb>\n        </p>\n        <Form>\n          <Form.Item label=\"MatrixID\">\n            <Input id=\"matrixID\" value={this.state.matrixID} onChange={this.onChangeValue}/>\n          </Form.Item>\n          <Form.Item label=\"Password\">\n            <Input.Password id=\"password\" value={this.state.password} onChange={this.onChangeValue}/>\n          </Form.Item>\n          <Form.Item>\n            <Checkbox\n            id=\"admin\"\n            checked={this.state.admin} onChange={this.onChangeChecked}\n                        >Admin</Checkbox>\n          </Form.Item>\n          <Form.Item>\n            <Button onClick={this.onCreateUser}>Create</Button>\n          </Form.Item>\n        </Form>\n      </div>\n    );\n  }\n}\n\nexport default UserCreate2;\n","import React, { useState } from \"react\";\nimport { Link } from 'react-router-dom';\nimport { Breadcrumb, Button, Checkbox, Dropdown, Form, Input, Modal, Table, Menu } from \"antd\";\n\nimport UserCreate from './UserCreate';\n\nfunction UserList({users, onCreateUser, onChangeActive, onChangeAdmin, self}) {\n  let [modalCreateOpen, setModalCreateOpen] = useState();\n\n  let [matrixID, setMatrixID] = useState('');\n  let [password, setPassword] = useState('');\n  let [admin, setAdmin] = useState(false);\n\n  function onClickCreateUser() {\n    onCreateUser(matrixID, password, admin);\n  };\n  function onChangeMatrixID(e) {\n    setMatrixID(e.target.value);\n  };\n  function onChangePassword(e) {\n    setPassword(e.target.value);\n  };\n  function onChangeAdmin(e) {\n    setAdmin(e.target.checked);\n  };\n\n  return (\n    <div>\n      <Modal visible={modalCreateOpen} okText=\"Create\" onCancel={() => setModalCreateOpen(false)} onOk={onClickCreateUser}\n      >\n        <Form>\n          <Form.Item label=\"MatrixID\">\n            <Input value={matrixID} onChange={onChangeMatrixID}/>\n          </Form.Item>\n          <Form.Item label=\"Password\">\n            <Input.Password value={password} onChange={onChangePassword}/>\n          </Form.Item>\n          <Form.Item>\n            <Checkbox checked={admin} onChange={onChangeAdmin}>Admin</Checkbox>\n          </Form.Item>\n        </Form>\n      </Modal>\n      <p>\n        <Breadcrumb>\n          <Breadcrumb.Item>\n            <Link to=\"/\">Home</Link>\n          </Breadcrumb.Item>\n          <Breadcrumb.Item>\n            Users\n          </Breadcrumb.Item>\n        </Breadcrumb>\n      </p>\n      <p>\n        <Button onClick={() => setModalCreateOpen(true)}>Create</Button>\n      </p>\n      <Table\n        columns={\n          [\n            {\n              title: 'MatrixID',\n              dataIndex: 'name',\n              render: matrixID => (\n                <Link to={'/user/'+matrixID}>\n                  {matrixID}\n                </Link>\n              ),\n            },\n            {\n              title: 'Name',\n              dataIndex: 'displayname',\n            },\n            {\n              title: 'Deactivated',\n              dataIndex: 'deactivated',\n            },\n            {\n              title: 'Guest',\n              dataIndex: 'is_guest',\n            },\n            {\n              title: 'Admin',\n              dataIndex: 'admin',\n            },\n            /*{\n              render: user => (\n                <Dropdown trigger=\"click\" overlay={\n                  <Menu>\n                    <Menu.Item>\n                      Make Admin\n                    </Menu.Item>\n                    <Menu.Item>\n                      Make Guest\n                    </Menu.Item>\n                    <Menu.Item>\n                      Deactivate\n                    </Menu.Item>\n                  </Menu>\n                }>\n                  <a>Modify</a>\n                </Dropdown>\n              ),\n            },*/\n          ]\n        }\n        dataSource={\n          users\n        }\n      />\n    </div>\n  )\n}\n\nexport default UserList;\n","import React from \"react\";\nimport { HashRouter as Router, Link, Route,Switch } from 'react-router-dom';\nimport { Layout } from 'antd';\n\nimport Media from './Media';\nimport MediaList from './MediaList';\nimport Home from './Home';\nimport LogIn from './LogIn';\nimport LogOut from './LogOut';\nimport Room from './Room';\nimport RoomList from './RoomList';\nimport Server from './Server';\nimport Register from './Register';\nimport User from './User';\nimport UserCreate from './UserCreate';\nimport UserList from './UserList';\n\nclass App extends React.Component {\n  state = {\n    status: 'loading',\n    users: [],\n    homeserver: null,\n    accessToken: null,\n    userID: null,\n  };\n\n  api = async (method, url, body) => {\n    console.log('api', method, url)\n    const res = await fetch(this.state.homeserver+url, {\n      method: method,\n      headers: {\n\n      },\n      body: JSON.stringify(body)\n    });\n    return res.json();\n  }\n\n  api2 = async (method, url, body) => {\n    console.log('api2', method, url)\n    const res = await fetch(this.state.homeserver+url, {\n      method: method,\n      headers: {\n        Authorization: 'Bearer '+this.state.accessToken,\n      },\n      body: JSON.stringify(body)\n    });\n    let obj = await res.json();\n    if ('errcode' in obj) {\n      throw `${obj.errcode}: ${obj.error}`\n    }\n    if (!res.ok) {\n      throw `${obj.statusText}`;\n    }\n    return obj;\n  }\n\n  onLogIn = async (matrixID, password, homeserver) => {\n    this.setState({\n      homeserver: 'https://'+homeserver,\n    });\n    const res = await this.api('POST', '/_matrix/client/r0/login', {\n      type: 'm.login.password',\n      identifier: {\n        type: 'm.id.user',\n        user: matrixID,\n      },\n      password: password,\n      initial_device_display_name: 'NerveGear'\n    });\n    if ('access_token' in res) {\n      window.localStorage.setItem('mx_access_token', res.access_token);\n      window.localStorage.setItem('mx_user_id', res.user_id);\n      this.setState({\n        status: 'loggedin',\n        accessToken: res.access_token,\n        userID: res.user_id,\n      });\n      setTimeout(async () => {\n        await this.refresh();\n      });\n    }\n  };\n\n  onChange = (e) => {\n    this.setState({\n      [e.target.id]: e.target.value,\n    });\n  };\n\n  refresh = async () => {\n    console.log(this.state.status)\n    if (this.state.status === 'loggedin') {\n      console.log('refreAPI')\n      try {\n        const res = await this.api2('GET', '/_synapse/admin/v2/users?from=0&limit=10000&deactivated=true');\n        if ('users' in res) {\n          this.setState({\n            users: res.users,\n          });\n        }\n      } catch (e) {\n        console.log('error', e)\n      }\n    }\n  }\n\n  async componentDidMount() {\n    const accessToken = window.localStorage.getItem('mx_access_token')\n    if (accessToken) { \n      const userID = window.localStorage.getItem('mx_user_id');\n      let homeserver = userID.substr(userID.indexOf(':')+1)\n      this.setState({\n        status: 'loggedin',\n        accessToken: accessToken,\n        userID: userID,\n        homeserver: 'https://'+homeserver,\n      });\n    } else {\n      this.setState({\n        status: 'loggedout',\n      })\n    }\n    setTimeout(async () => {\n      await this.refresh();\n    });\n  }\n\n  onChangeAdmin = async (matrixID, admin) => {\n    await this.api2('PUT', '/_synapse/admin/v2/users/'+matrixID, {\n      admin: admin,\n    });\n    await this.refresh();\n  };\n\n  onChangeActive = async (matrixID, active) => {\n    if (active) {\n      const password = prompt('New password');\n      await this.api2('PUT', '/_synapse/admin/v2/users/'+matrixID, {\n        deactivated: false,\n        password: password,\n      });\n    } else {\n      await this.api2('POST', '/_synapse/admin/v1/deactivate/'+matrixID, {\n        erase: true,\n      });\n    }\n    await this.refresh();\n  };\n\n  onChangePassword = async (matrixID) => {\n    const password = prompt('New password');\n    await this.api2('PUT', '/_synapse/admin/v2/users/'+matrixID, {\n      password: password,\n    });\n    this.refresh();\n  }\n\n  onLogOut = async () => {\n    try {\n      await this.api2('POST', '/_matrix/client/r0/logout', {});\n    } catch (e) {\n      console.error(e);\n    }\n    window.localStorage.removeItem('mx_access_token');\n    window.localStorage.removeItem('mx_user_id');\n    this.setState({\n      status: 'loggedout',\n      users: [],\n      accessToken: null,\n      userID: null,\n    })\n  }\n\n  onCreateUser = async (matrixID, password, admin) => {\n    // TODO check if user already exists\n    console.log(matrixID, password, admin);\n    await this.api2('PUT', '/_synapse/admin/v2/users/'+matrixID, {\n      password: password,\n      admin: admin,\n    });\n    this.refresh();\n  }\n\n  render() {\n    return (\n      <Layout>\n        <Layout.Content style={{padding: '1em'}}>\n          <div style={{padding: '1em', backgroundColor: '#fff'}}>\n            <Router>\n              { this.state.status === 'loading' ?\n                <div>Loading...</div>\n              : this.state.status === 'loggedout' ?\n                <div>\n                  <Switch>\n                    <Route path=\"/register\">\n                      <Register\n                        onLogIn={this.onLogIn}\n                      />\n                    </Route>\n                    <Route>\n                      <LogIn\n                        onLogIn={this.onLogIn}\n                      />\n                    </Route>\n                  </Switch>\n                </div>\n              :\n                <div>\n                  <LogOut\n                    userID={this.state.userID}\n                    onLogOut={this.onLogOut}\n                  />\n                  <hr/>\n                  <Switch>\n                    <Route path=\"/user/create\" exact>\n                      <UserCreate\n                        onCreateUser={this.onCreateUser}\n                      />\n                    </Route>\n                    <Route path=\"/user/:userID\" children={\n                      <User\n                        users={this.state.users}\n                        api2={this.api2}\n                      />\n                    }/>\n                    <Route path=\"/media/:domain/:local\" children={\n                      <Media\n                        homeserver={this.state.homeserver}\n                        api2={this.api2}\n                      />\n                    }/>\n                    <Route path=\"/server\" exact>\n                      <Server\n                        api2={this.api2}\n                      />\n                    </Route>\n                    <Route path=\"/media\" exact>\n                      <MediaList\n                        api2={this.api2}\n                        homeserver={this.state.homeserver.substr(8)}\n                      />\n                    </Route>\n                    <Route path=\"/room\" exact children={\n                      <RoomList\n                        api2={this.api2}\n                      />\n                    }/>\n                    <Route path=\"/room/:roomID\" children={\n                      <Room\n                        api2={this.api2}\n                      />\n                    }/>\n                    <Route path=\"/user\" exact>\n                      <UserList\n                        self={this.state.matrixID}\n                        users={this.state.users}\n                        onChangeActive={this.onChangeActive}\n                        onChangeAdmin={this.onChangeAdmin}\n                        onChangePassword={this.onChangePassword}\n                      />\n                    </Route>\n                    <Route path=\"/\" exact>\n                      <Home/>\n                    </Route>\n                    <Route>\n                      <p><Link to=\"/user\">Users</Link></p>\n                    </Route>\n                  </Switch>\n                </div>\n              }\n            </Router>\n          </div>\n        </Layout.Content>\n        <Layout.Footer style={{textAlign: 'center', color: '#777777'}}>\n          NerveGear - homeserver administrator\n        </Layout.Footer>\n      </Layout>\n    );\n  }\n}\n\nexport default App;\n","import 'antd/dist/antd.css';\n\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}